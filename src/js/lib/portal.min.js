!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.portal=e.portal||{})}(this,function(e){"use strict";function t(e,t,n){return n="undefined"!=typeof n?n:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.responseType="json",s.withCredentials=n.withCredentials,s.addEventListener("readystatechange",function(){4===s.readyState&&200==s.status&&i(s.response)}),s.addEventListener("error",function(){o(Error(s))}),s.open("GET",e+"?"+r(t)),s.send()})}function n(e,t,n){return n="undefined"!=typeof n?n:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.responseType="json",s.withCredentials=n.withCredentials,s.addEventListener("readystatechange",function(){4===s.readyState&&200==s.status&&i(s.response)}),s.addEventListener("error",function(){o(Error(s))}),s.open("POST",e),s.setRequestHeader("content-type","application/x-www-form-urlencoded"),s.send(r(t))})}function r(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)){var o=t?t+"["+i+"]":i,s=e[i];n.push("object"==("undefined"==typeof s?"undefined":D(s))?r(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return n.join("&")}function i(e,t){var n=this,r=n.portalUrl+"sharing/rest/generateToken",i={client:"referer",referer:window.location.hostname,expiration:60,username:e,password:t,f:"json"},o={withCredentials:n.withCredentials};return A.post(r,i,o)}function o(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/search",s={q:e,num:t,sortField:n,sortOrder:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return A.get(o,s,a)}function s(){var e=this,t=e.portalUrl+"sharing/rest/portals/self",n={token:e.token,f:"json"},r={withCredentials:e.withCredentials};return A.get(t,n,r)}function a(){var e=this,t=e.portalUrl+"sharing/rest",n={f:"json"},r={withCredentials:e.withCredentials};return A.get(t,n,r)}function l(e,t){var n=this,r=n.portalUrl+"sharing/rest/content/users/"+e+"/"+t,i={token:n.token,f:"json"},o={withCredentials:n.withCredentials};return A.get(r,i,o)}function c(e){var t=this,n=t.portalUrl+"sharing/rest/community/users/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return A.get(n,r,i)}function u(e,t,n,r,i){var o=this,s=o.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/addItem";for(var a in n)null===n[a]?n[a]="":n[a]instanceof Array&&(n[a]=n[a].toString());var l={item:n.title,text:JSON.stringify(r),overwrite:!1,thumbnailurl:i,token:o.token,f:"json"};Object.assign(l,n);var c={withCredentials:o.withCredentials};return A.post(s,l,c)}function h(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e+"/data",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return A.get(n,r,i)}function p(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return A.get(n,r,i)}function d(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s={text:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return A.post(o,s,a)}function f(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s=!0,a=!1,l=void 0;try{for(var c,u=r[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var h=G(c.value,2),p=h[0],d=h[1];null===d?r[p]="":d instanceof Array&&(r[p]=d.toString())}}catch(e){a=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(a)throw l}}var f=JSON.parse(r);f.token=i.token,f.f="json";var y={withCredentials:i.withCredentials};return A.post(o,f,y)}function y(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={url:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return A.post(o,s,a)}function w(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={text:JSON.stringify(r),token:i.token,f:"json"},a={withCredentials:i.withCredentials};return A.post(o,s,a)}function v(e,t,n){var r=this,i=e+"/"+t+"/addFeatures",o={features:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return A.post(i,o,s)}function C(e,t){var n=this;e=e.replace("/rest/services/","/rest/admin/services/");var r=e+"/addToDefinition",i={addToDefinition:t,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return A.post(r,i,o)}function m(e){this.items.push({id:e.id,description:e})}function g(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/portals/"+e+"/isServiceNameAvailable",o={name:t,type:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return A.get(i,o,s)}function k(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/createService",o={createParameters:n,outputType:"featureService",token:r.token,f:"json"},s={withCredentials:r.withCredentials};return A.post(i,o,s)}function S(e,t,n,r){var i=this,o=e+"/"+t+"/query",s={where:"1=1",outFields:"*",returnGeometry:!0,resultOffset:n,resultRecordCount:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return A.get(o,s,a)}function b(e,t){var n=this,r=e+"/"+t+"/query",i={where:"1=1",returnCountOnly:!0,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return A.get(r,i,o)}function j(e){var t=this,n=e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return A.get(n,r,i)}function U(e){var t=this,n=e+"/layers",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return A.get(n,r,i)}function O(e){var t=P.filter(function(t){return t.type===e})[0];return t="undefined"!=typeof t?t:{icon:"datafilesGray"}}function x(e){return new Promise(function(t){""===e?e="https://www.arcgis.com/":e.search("/home/")>0?e=e.substr(0,e.search("/home"))+"/":e.search("/sharing")>0?e=e.substr(0,e.search("/sharing"))+"/":"/"!==e.charAt(e.length-1)&&(e+="/"),0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),t(e)})}function T(e){return 0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),e}function L(e){return O(e)}var D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},E=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},G=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),A={get:t,post:n},P=[{type:"CityEngine Web Scene",icon:"webScene"},{type:"Color Set",icon:"datafilesGray"},{type:"Document Link",icon:"datafilesGray"},{type:"Image Service",icon:"imagery"},{type:"Feature Collection",icon:"features"},{type:"Feature Collection Template",icon:"maps"},{type:"Feature Layer",icon:"features"},{type:"Feature Service",icon:"features"},{type:"Geocoding Service",icon:"layers"},{type:"Geodata Service",icon:"layers"},{type:"Geometry Service",icon:"layers"},{type:"Geoprocessing Service",icon:"layers"},{type:"Globe Service",icon:"layers"},{type:"Network Analysis Service",icon:"layers"},{type:"Map Service",icon:"layers"},{type:"Mobile Application",icon:"apps"},{type:"Operation View",icon:"apps"},{type:"Scene Layer",icon:"sceneLayer"},{type:"Scene Service",icon:"sceneLayer"},{type:"Service Definition",icon:"datafiles"},{type:"Symbol Set",icon:"datafiles"},{type:"Web Map",icon:"maps"},{type:"Web Mapping Application",icon:"apps"},{type:"Web Scene",icon:"webScene"},{type:"WMS",icon:"layers"}],F=Object.freeze({fixUrl:x,upgradeUrl:T}),I=function e(t){E(this,e),t="undefined"!=typeof t?t:"{}",this.portalUrl="undefined"!=typeof t.portalUrl?t.portalUrl:"https://www.arcgis.com",this.username="undefined"!=typeof t.username?t.username:"",this.token="undefined"!=typeof t.token?t.token:"",this.withCredentials="undefined"!=typeof t.withCredentials&&t.withCredentials,this.items=[],this.services=[],console.log("new portal"),console.log(this.portalUrl),this.generateToken=i,this.search=o,this.self=s,this.version=a,this.userContent=l,this.userProfile=c,this.itemDescription=p,this.itemData=h,this.addItem=u,this.updateWebmapData=w,this.updateDescription=f,this.updateData=d,this.updateUrl=y,this.serviceDescription=j,this.serviceLayers=U,this.layerRecordCount=b,this.createService=k,this.addToServiceDefinition=C,this.checkServiceName=g,this.harvestRecords=S,this.addFeatures=v,this.cacheItem=m},M=F;e.Portal=I,e.itemInfo=L,e.util=M,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=portal.min.js.map
